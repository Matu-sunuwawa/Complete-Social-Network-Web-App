{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{% block title %}Social App{% endblock %}</title>
  <link rel="stylesheet" href="{% static 'css/main.css' %}">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body> <main class="container container-top">
    {% block content %}
    {% endblock %}
  </main>

  <div id="modals-here" class="modal fade" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content border-0 rounded-5 p-2" id="modal-content-target">
            </div>
    </div>
  </div>

  {% include "core/includes/_mobile_nav.html" %}

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="{% static 'js/htmx.min.js' %}"></script>

  <script>
      document.body.addEventListener('htmx:configRequest', (event) => {
          event.detail.headers['X-CSRFToken'] = '{{ csrf_token }}';
      });

      document.body.addEventListener('htmx:afterSwap', function(evt) {
          if (evt.detail.target.id === "modal-content-target") {
              const modalElement = document.getElementById('modals-here');
              const modal = new bootstrap.Modal(modalElement);
              modal.show();
          }
      });

      function updateActiveLinks() {
          const currentPath = window.location.pathname;
          document.querySelectorAll('.menu-item-link').forEach(link => {
              link.classList.toggle('active', link.getAttribute('href') === currentPath);
          });
      }

      document.body.addEventListener('htmx:afterOnLoad', updateActiveLinks);
      window.addEventListener('load', updateActiveLinks);
  </script>
</body>
</html>
