{% load static %}

<div class="d-flex align-items-center mb-3">
  <button class="btn btn-link text-decoration-none text-primary p-0"
          hx-get="{% url 'core:home' %}"
          hx-target="#post-list"
          hx-swap="innerHTML">
    ‚Üê Back
  </button>
</div>

<div class="bg-white rounded-5 p-3 mt-4 shadow-sm post-card">
  <div class="d-flex align-items-center py-2">
    <img src="{% static 'assets/Group 8.png' %}" alt="">
    <div class="ps-3">
      <h3 class="h5 mb-0">{{post.user.username}}</h3>
      <p class="text-muted small mb-0">{{post.created_at}}</p>
    </div>
  </div>

  <p>
    {{post.content}}
  </p>

  <div class="post-gallery">
    {% if post.image %}
      <img src="{{ post.image.url }}" alt="post img" />
    {% endif %}
  </div>

  <div class="border-top d-flex mt-3 pt-2">
    <div class="px-2 d-flex align-items-center gap-1 cursor-pointer">
      6355 <img src="{% static 'assets/eye-24-outlined.svg' %}" alt="">
    </div>
    <div
      class="px-2 d-flex align-items-center gap-1 cursor-pointer"
      hx-post="{% url 'post:like_post' post.id %}"
      hx-target="#like-section-{{post.id}}"
      hx-swap="innerHTML"
    >
      <div id="like-section-{{post.id}}">
        {% include 'post/partials/like_button.html' with post=post %}
      </div>
    </div>
  </div>

  <div class="bg-white p-2 border-top mt-3">
    <form hx-post="{% url 'post:comment_create' post.id %}"
      hx-target="#comment-list-{{ post.id }}"
      hx-swap="afterbegin"
      hx-on::after-request="if(event.detail.successful) { this.reset(); document.querySelector('.no-comments-msg')?.remove(); }"
    >
      {% csrf_token %}
      <div class="d-flex align-items-center pt-3"> <img src="{% static 'assets/Group 8.png' %}" class="rounded-circle" width="35" height="35" alt="" />

        <textarea name="content"
                  class="form-control-search ms-2"
                  rows="1"
                  placeholder="Post your reply..."
                  style="flex: 1; border: none; outline: none;"
                  required></textarea>
      </div>
      <div class="d-flex justify-content-end pt-2">
        <button type="submit" class="btn btn-primary fw-medium px-4 rounded-pill">Reply</button>
      </div>
    </form>
  </div>

  <div id="comment-list-{{ post.id }}" class="mt-4 px-2">
    {% for comment in post.comments.all %}
      {% include 'post/partials/comment.html' with comment=comment %}
    {% empty %}
      <p class="text-muted small text-center py-3 no-comments-msg">No comments yet. Be the first to reply!</p>
    {% endfor %}
  </div>

</div>
